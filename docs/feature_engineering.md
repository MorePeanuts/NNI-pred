## 数据集概况

### 水体变量说明

| 列名       | 说明               | 备注                             |
| ---------- | ------------------ | -------------------------------- |
| ID         | 样本编号           | 编号不作为模型输入               |
| THIA       | 噻虫嗪             | 污染物 (母体)                    |
| IMI        | 吡虫啉             | 污染物 (母体)                    |
| CLO        | 噻虫胺             | 污染物 (母体)                    |
| ACE        | 啶虫脒             | 污染物 (母体)                    |
| DIN        | 呋虫胺             | 污染物 (母体)                    |
| parentNNIs | 母体新烟碱         | 污染物 (母体)                    |
| IMI-UREA   | 吡虫啉尿素         | 污染物 (代谢物)                  |
| DN-IMI     | 去甲基吡虫啉       | 污染物 (代谢物)                  |
| DM-ACE     | 去硝基             | 污染物 (代谢物)                  |
| CLO-UREA   | 噻虫胺脲           | 污染物 (代谢物)                  |
| mNNIs      | 新烟碱代谢物       | 污染物 (代谢物)                  |
| Season     | 季节               | 包含 Dry, Normal, Rainy 三种取值 |
| DO         | 溶解氧             | 随季节变化                       |
| pH         |                    | 随季节变化                       |
| COND       | 电导率             | 随季节变化                       |
| DOC        | 溶解性有机质       | 随季节变化                       |
| T_W        | 水温               | 随季节变化                       |
| T_M        | 气温               | 随季节变化                       |
| PREC       | 降水               | 随季节变化                       |
| Lon        | 经度               | 位置信息，不作为模型输入         |
| Lat        | 纬度               | 位置信息，不作为模型输入         |
| Alt        | 海拔               | 位置信息，作为模型输入           |
| Landuse    | 土地利用           | 年均值，与季节无关               |
| Urban      | 城市化率           | 年均值，与季节无关               |
| GDP        | 生产总值           | 年均值，与季节无关               |
| PR         | 第一产业占比       | 年均值，与季节无关               |
| SR         | 第二产业占比       | 年均值，与季节无关               |
| TR         | 第三产业占比       | 年均值，与季节无关               |
| UI         | 城市居民可支配收入 | 年均值，与季节无关               |
| RI         | 农村居民可支配收入 | 年均值，与季节无关               |
| UR_W       | 城市生活用水       | 年均值，与季节无关               |
| RU_W       | 农村生活用水       | 年均值，与季节无关               |
| AGR_W      | 农业用水           | 年均值，与季节无关               |
| IND_W      | 工业用水           | 年均值，与季节无关               |
| LIF_W      | 生活用水           | 年均值，与季节无关               |
| POP_TOT    | 总人口             | 年均值，与季节无关               |
| OP_FI      | 第一产业值         | 年均值，与季节无关               |
| OP_SE      | 第二产业值         | 年均值，与季节无关               |
| OP_TH      | 第三产业值         | 年均值，与季节无关               |
| AO         | 农业总收入         | 年均值，与季节无关               |
| FO         | 林业总收入         | 年均值，与季节无关               |
| AMP        | 农用机械总动力     | 年均值，与季节无关               |
| FER        | 化肥用量           | 年均值，与季节无关               |
| PES        | 农药用量           | 年均值，与季节无关               |
| FERPER     | 单位面积化肥用量   | 年均值，与季节无关               |
| PESPER     | 单位面积农药用量   | 年均值，与季节无关               |
| TSA        | 总播种面积         | 年均值，与季节无关               |
| FCA        | 粮食作物比重面积   | 年均值，与季节无关               |
| WA         | 小麦播种面积       | 年均值，与季节无关               |
| CA         | 玉米播种面积       | 年均值，与季节无关               |
| VEGA       | 蔬菜种植面积       | 年均值，与季节无关               |
| ARCA       |                    | 年均值，与季节无关               |
| CROPOUT    | 粮食作物产量       | 年均值，与季节无关               |
| WO         | 小麦产量           | 年均值，与季节无关               |
| CO         | 玉米产量           | 年均值，与季节无关               |
| VO         | 蔬菜产量           | 年均值，与季节无关               |
| FOP        | 水果产量           | 年均值，与季节无关               |
| IRR_W      | 灌溉用水           | 年均值，与季节无关               |

### 土壤变量说明

| 列名           | 说明               | 备注                             |
| -------------- | ------------------ | -------------------------------- |
| ID             | 样本编号           | 编号不作为模型输入               |
| THIA           | 噻虫嗪             | 污染物 (母体)                    |
| IMI            | 吡虫啉             | 污染物 (母体)                    |
| CLO            | 噻虫胺             | 污染物 (母体)                    |
| parentNNIs     | 母体新烟碱         | 污染物 (母体)                    |
| IMI-UREA       | 吡虫啉脲           | 污染物 (代谢物)                  |
| DN-IMI         | 去甲基吡虫啉       | 污染物 (代谢物)                  |
| CLO-UREA       | 噻虫胺脲           | 污染物 (代谢物)                  |
| mNNIs          | 新烟碱代谢物       | 污染物 (代谢物)                  |
| Season         | 季节               | 包含 Dry, Normal, Rainy 三种取值 |
| pH             |                    | 随季节变化                       |
| TN             | 总氮               | 随季节变化                       |
| TOC            | 总有机碳           | 随季节变化                       |
| Temp           | 地面温度           | 随季节变化                       |
| Rain           | 降雨量             | 随季节变化                       |
| EVI            | 增强型植被指数     | 随季节变化                       |
| FCOVER         | 植被覆盖           | 随季节变化                       |
| LAI            | 叶面指数           | 随季节变化                       |
| LST            | 热度指数           | 随季节变化                       |
| NDVI           | 归一化植被指数     | 随季节变化                       |
| Lon            | 经度               | 位置信息，不作为模型输入         |
| Lat            | 纬度               | 位置信息，不作为模型输入         |
| Alt            | 海拔               | 位置信息，作为模型输入           |
| CC             | 粘土含量           | 年均值，与季节无关               |
| BD             | 土壤容量           | 年均值，与季节无关               |
| GPAM           | 农用机械总动力     | 年均值，与季节无关               |
| WS             | 小麦播种面积       | 年均值，与季节无关               |
| FER            | 化肥用量           | 年均值，与季节无关               |
| PES            | 农药用量           | 年均值，与季节无关               |
| MC             | 小麦产量           | 年均值，与季节无关               |
| MCP            | 小麦单位面积产量   | 年均值，与季节无关               |
| VE             | 蔬菜产量           | 年均值，与季节无关               |
| VEP            | 蔬菜单位面积产量   | 年均值，与季节无关               |
| FR             | 水果产量           | 年均值，与季节无关               |
| FRP            | 水果单位面积产量   | 年均值，与季节无关               |
| FERA           | 单位面化肥用量     | 年均值，与季节无关               |
| PESA           | 单位面积农药用量   | 年均值，与季节无关               |
| UR             | 城市化率           | 年均值，与季节无关               |
| GAO            | 农业总产值         | 年均值，与季节无关               |
| landuse        | 土地利用           | 年均值，与季节无关               |
| PR             | 第一产业占比       | 年均值，与季节无关               |
| SR             | 第二产业占比       | 年均值，与季节无关               |
| TR             | 第三产业占比       | 年均值，与季节无关               |
| GDP per capita | 人均GDP            | 年均值，与季节无关               |
| UI             | 城市居民可支配收入 | 年均值，与季节无关               |
| RI             | 农村居民可支配收入 | 年均值，与季节无关               |
| UR_W           | 城市生活用水       | 年均值，与季节无关               |
| RU_W           | 农村生活用水       | 年均值，与季节无关               |
| IRR_W          | 灌溉用水           | 年均值，与季节无关               |
| AGR_W          | 农业用水           | 年均值，与季节无关               |
| IND_W          | 工业用水           | 年均值，与季节无关               |
| LIF_W          | 生活用水           | 年均值，与季节无关               |


### 数据集描述

原始数据为两份独立采样的数据集（土壤和水体），无时间序列（只有季节分类），采样点空间不重合。

- 土壤数据集
  - 样本量：186 个（62 个空间位置，每个位置 Rainy、Dry、Normal 三个季节各一个样本）。
  - 目标变量：
    - 母体污染物：THIA, IMI, CLO, 以及母体污染物之和 parentNNIs
    - 母体代谢物：IMI-UREA, DN-IMI, CLO-UREA, 以及代谢物污染物之和 mNNIs
- 水体数据集
  - 样本量：159 个（53 个空间位置，每个位置 Rainy、Dry、Normal 三个季节各一个样本）。
  - 目标变量：
    - 母体污染物：THIA, IMI, CLO, ACE, DIN, 以及母体污染物之和 parentNNIs
    - 母体代谢物：IMI-UREA, DN-IMI, CLO-UREA, DM-ACE, 以及代谢物污染物之和 mNNIs

## 数据预处理

### 水土样本匹配

我们将水体样本视为“受体”，将其周边的土壤样本视为“源”。

- 对于第 $i$ 个水体样本 $W_i$ (坐标 $Lat_i, Lon_i$)，设定搜索半径 $R=30km$ 
- 找到所有落入 $W_i$ 半径 $R$ 范围内的土壤样本集合 $S_{neighbors}$
- 仅选择与 $W_i$ 属于同一季节的土壤样本进行聚合，确保水土的时间同步性。
- 特征聚合 (IDW加权)：将土壤的所有数值特征聚合为水体样本的新特征。

$$
V_{soil\_agg} = \frac{\sum_{j=1}^{k} w_{ij} \cdot V_{soil\_j}}{\sum_{j=1}^{k} w_{ij}}
$$

其中权重 $w_{ij} = \frac{1}{d_{ij}^p}$，$d_{ij}$ 为水体 $i$ 与土壤 $j$ 的欧氏距离，$p=2$ 为幂指数。

- 聚合后的变量命名为 `Soil_THIA_agg`, `Soil_TOC_agg` 等，作为 $W_i$ 的输入特征。
- 取距离最近的一个土壤样本点的分类特征，命名为 `Soil_landuse` 等

### 通用数据预处理

- 水土样本匹配：见上一节
- 对分类变量（`Season`, `Landuse`, `Soil_landuse`）进行独热编码
- 对目标变量（11种污染物浓度）进行 Log1p 变换

### 分组 PCA 降维

为了在消除共线性，减少特征数量，同时避免“全局 PCA”导致物理意义混合（如将自然降雨与人为排放混为一谈），我们采用**分组主成分分析**策略。所有特征将被划分为三类分别处理，其中农业集约化特征和社会经济发展特征这两组特征需要标准化后进行 PCA 降维。

以下是特征的分组：

- **自然驱动与空间异质性特征**：保留原始值（不做 PCA）。迁移过程的直接驱动力（降雨、地形）和源-汇关系的直接证据。
  - **目标变量**：各种污染物浓度
  - **气象因子 (Meteorological):**
    - `PREC` (水体点降雨), `T_M` (气温), `T_W` (水温)。
    - `Soil_Rain_agg` (周边降雨背景), `Soil_Temp_agg` (周边地温背景)。
  - **水土理化性质 (Physicochemical):**
    - 水体： `DO` (溶解氧), `pH`, `COND` (电导率), `DOC` (溶解性有机碳)。
    - 土壤： `Soil_pH_agg`, `Soil_TN_agg` (总氮), `Soil_TOC_agg` (总有机碳), `Soil_CC_agg` (粘土含量), `Soil_BD_agg` (土壤容重)。
  - **植被与地形 (Vegetation & Topography):**
    - `Alt` (海拔), `Soil_Alt_agg`, `Soil_NDVI_agg`, `Soil_EVI_agg`, `Soil_LAI_agg` (叶面积指数), `Soil_FCOVER_agg` (植被覆盖度)。
  - **时空标识与分类变量:**
    - `Season` (季节), `Landuse` (水体点土地利用), `Soil_landuse` (周边主要土地利用)。
- **农业集约化特征（Agro-Intensity Group）**：共 32 个变量，独立 PCA，提取 `PC_Agro`。反映化肥农药的投入强度及农业生产规模，代表“农业面源污染压力”。
  - **农业投入品 (Inputs):**
    - `FER`, `Soil_FER_agg` (化肥总量); `FERPER`, `Soil_FERA_agg` (单位面积化肥)。
    - `PES`, `Soil_PES_agg` (农药总量); `PESPER`, `Soil_PESA_agg` (单位面积农药)。
    - `AMP`, `Soil_GPAM_agg` (农业机械总动力)。
  - **种植规模 (Crop Area):**
    - `TSA` (总播种面积), `FCA` (粮食作物面积)。
    - `WA`, `Soil_WS_agg` (小麦面积), `CA` (玉米面积), `VEGA` (蔬菜面积), `ARCA`.
  - **农业产出 (Yields):**
    - `CROPOUT` (粮食总产量)。
    - `WO` , `Soil_MC_agg` (小麦产量), `CO` (玉米产量), `VO` , `Soil_VE_agg` (蔬菜产量), `FOP` / `Soil_FR_agg` (水果产量)。
    - `Soil_MCP_agg`, `Soil_VEP_agg`, `Soil_FRP_agg` (各类作物的单产)。
  - **农业用水 (Ag Water):**
    - `AGR_W`, `Soil_AGR_W_agg` (农业用水量), `IRR_W`, `Soil_IRR_W_agg` (灌溉用水量)。
- **社会经济发展特征（Socio-Economic Group）**：共 29 个变量，独立 PCA，提取 `PC_Socio`。反映城市化水平、工业化程度及人口聚集度，代表“点源排放与生活污染压力”。
  - **宏观经济 (Macro Economy):**
    - `GDP`, `Soil_GDP per capita_agg` (人均GDP)。
    - `OP_FI` (一产值), `OP_SE` (二产值), `OP_TH` (三产值)。
    - `AO` (农业总产值), `FO` (林业总产值), `Soil_GAO_agg` (农业总产值背景)。
  - **城市化与人口 (Urbanization & Pop):**
    - `Urban` (城市化率), `Soil_UR_agg` (周边城市化率), `POP_TOT` (总人口)。
  - **产业结构与收入 (Structure & Income):**
    - `PR`, `Soil_PR_agg` (一产占比); `SR`, `Soil_SR_agg` (二产占比); `TR`, `Soil_TR_agg` (三产占比)。
    - `UI`, `Soil_UI_agg` (城镇居民收入); `RI`, `Soil_RI_agg` (农村居民收入)。
  - **生活与工业用水 (Non-Ag Water):**
    - `UR_W`, `Soil_UR_W_agg` (城镇生活用水); `RU_W`, `Soil_RU_W_agg` (农村生活用水)。
    - `IND_W`, `Soil_IND_W_agg` (工业用水); `LIF_W`, `Soil_LIF_W_agg` (生活总用水)。

### 特征缩放和偏态特征处理（线性模型）

针对线性模型，还需进行额外的数据处理，为满足线性模型（Elastic Net）对数据分布的假设要求，并将非线性特征转化为模型更易捕捉的形式，将对训练集中“自然驱动与空间异质性特征”组实施以下处理流程：

- **分布诊断：** 对连续型输入变量进行偏度（Skewness）计算。
- **适应性变换：**
  - 对于**高偏度变量**（判定阈值设定为 $|Skewness| > 0.75$），统一执行 Log(x+1) 对数变换，以压缩长尾、修正分布偏差。
  - 对于**近正态分布变量**（如 pH、温度、溶解氧等），**保留原始数值**，避免不必要的数学变换引入解释性噪音。
- 使用 Z-score 进行标准化

